SELECT
    DEVICE_NAME,
    SOURCE_IP AS DEVICE_IP,
    SERIAL_NUMBER
FROM RAW.PAN_FIREWALL_THREAT
WHERE GENERATED_TIME > CURRENT_TIMESTAMP - INTERVAL '30 days' -- Adjust to your liking
  AND THREAT_ID ILIKE ANY ('%510000%', '%510001%')
QUALIFY ROW_NUMBER() OVER (PARTITION BY DEVICE_NAME ORDER BY GENERATED_TIME DESC) = 1;
