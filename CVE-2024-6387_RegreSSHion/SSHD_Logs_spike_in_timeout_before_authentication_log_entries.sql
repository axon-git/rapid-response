SELECT MIN(TIMESTAMP)                                    AS MIN_EVENT_TIME,
       MAX(TIMESTAMP)                                    AS MAX_EVENT_TIME,
       HOST_NAME                                         AS HOST_NAME,
       ARRAY_AGG(DISTINCT PROCESS_ID)                    AS PIDs,
       IP_ADDRESS                                        AS IP_ADDRESS,
       ARRAY_AGG(DISTINCT PORT)                          AS PORT_NUMs,
       ARRAY_AGG(DISTINCT MESSAGE)                       AS MESSAGE,
       DATE_TRUNC('DAY', TIMESTAMP)                      AS RELEVANT_DAY,
       COUNT(*)                                          AS COUNTER
FROM RAW.LINUX_SSHD_LOGS
WHERE MESSAGE ILIKE '%timeout before authentication%'
-- Adjust timeframe based on needs
AND TIMESTAMP  > current_timestamp - interval '30d'
GROUP BY 3,5,8
-- Adjust threshold based on needs and/or organizational characteristics
HAVING COUNTER > 250
ORDER BY RELEVANT_DAY ASC
